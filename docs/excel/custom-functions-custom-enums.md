---
title: Custom enums for custom functions
description: Create custom enums to use with your custom functions.
ms.date: 06/24/2025
ms.localizationpriority: medium
---

# Create custom enums for your custom functions

:::image type="content" source="../images/custom-functions-custom-enum-autocomplete.png" alt-text="The members of a custom enum displaying in the Excel AutoComplete menu.":::

With custom enums, the members in your enum display in the Excel AutoComplete menu for your custom function. The planets in the preceding screenshot are members of a custom enum. This article describes how create custom enums and use them as parameters in your custom functions.

## Define the custom enum

Define your enum with the JSDoc tag `@customenum`. The corresponding JSON properties are then autogenerated in your custom function metadata. For more information about JSDoc tags and custom functions, see [Basics of JSDoc tags](custom-functions-json-autogeneration.md#basics-of-jsdoc-tags).

> [!NOTE]
> Custom enums created with the `@customenum` JSDoc tag are only supported in TypeScript. They are not supported in JavaScript. To use custom enums with JavaScript functions, see [Edit enums in JSON metadata](#edit-enums-in-json-metadata).

The following code snippet shows how to define and use a simple custom enum as a parameter.

```typescript
/** 
 * A custom enum with descriptions and tooltips. 
 * @customenum {string} 
 */
enum PLANETS { 
  /** Mercury is the first planet from the sun. */ 
  mercury = "Mercury", 

  /** Venus is the second planet from the sun. */ 
  venus = "Venus", 

  /** Earth is the third planet from the sun. */ 
  earth = "Earth", 
} 

/** 
 * A sample function that uses the custom enum as a parameter.
 * @customfunction 
 */ 
function getPlanets(value: PLANETS): any { 
  return value; 
} 
```

## Edit enums in JSON metadata

Create or edit enum metadata directly with the `enums` property. Each custom enum must have a unique ID value and type value of either `string` or `number`. Mixed type enums are not supported.

If you manually create the JSON metadata for your custom enum, you can associate those enums with either TypeScript or JavaScript custom functions. To learn more about manually creating JSON metadata, see [Manually create JSON metadata for custom functions in Excel](custom-functions-json.md).

The following JSON snippet shows the metadata for the first two planets from the `PLANETS` enum in the previous code sample.

```json
"enums": [ 
    { 
        "id": "PLANETS", 
        "type": "string", 
        "values": [ 
            { 
                "name": "Mercury", 
                "value": "mercury", 
                "tooltip": "Mercury is the first planet from the sun." 
            }, 
            { 
                "name": "Venus", 
                "value": "venus", 
                "tooltip": "Venus is the second planet from the sun." 
            }
        ] 
    }
]
```

Each constant in the `values` array is an object with the following properties.

- **value**: The value of the constant.
- **name**: A brief description of the constant.
- **tooltip** (Optional): Additional information about the constant that can be shown as a tooltip in user interfaces.

To associate the custom enum with a function, add the property `customEnumType` to the `parameters` object. The `customEnumType` value should match the `id` of the enum. Note that the `customEnumType` value is not case-sensitive. The following JSON snippet shows a `functions` object associated with the `PLANETS` enum.

```json
"functions": [ 
    {
        "description": "A sample function that uses the custom enum as a parameter.", 
        "id": "BASICCUSTOMFUNCTION.GETPLANETS", 
        "name": "BASICCUSTOMFUNCTION.GETPLANETS", 
        "parameters": [ 
            { 
                "name": "value", 
                "type": "string", 
                "customEnumType": "PLANETS" 
            }
        ], 
        "result": {} 
    } 
]
```

## Use a custom enum multiple times

An custom enum can be reused in multiple functions, and it can be used as multiple parameters of a single function. A function can also have multiple enums as parameters at the same time. An enum parameter can be repeating or optional.

The following code sample shows a `NUMBERS` enum and a custom function that uses the enum multiple times as an input value.

```typescript
/**
* Enum of numbers with descriptions and tooltips.
* @customenum {number}
*/ 
enum NUMBERS {
  /** One */
  One = 1,

  /** Two */
  Two = 2,

  /** Three */
  Three = 3, 

  /** Four */
  Four = 4,

  /** Five */
  Five = 5
} 

/**
* Enter multiple numbers from the NUMBERS enum and get the sum.
* @customfunction
* @param input Enter enum numbers.
* @returns
*/
function addNumbers(input: NUMBERS[]): any {
  const sum = input.reduce((acc, num) => acc + num, 0); 
  return "Sum: " + sum; 
}
```

## Localize your custom enums

Localizing custom enums is similar to [localizing custom functions](custom-functions-naming.md#localize-custom-functions). Create a new JSON metadata file for each language.

Note that only the `name` and `tooltip` properties within an enum should be localized to the target language. The `value` property should remain unchanged to avoid the need for handling multiple languages within your function body.

The following JSON snippet shows a localized `values` object for the planet Mercury.

```json
"enums": [
    {
        "id": "PLANETS",
        "type": "string",
        "values": [
            {
                "name": "水星", 
                "value": "mercury",
                "tooltip": "水星是距离太阳最近的行星"
            },
        ]
    }
],
```

## Backwards compatibility

Custom enums offer backwards compatibility. On older versions of Excel, parameters using a custom enum work as standard parameters without displaying in the Excel AutoComplete list.

## See also

- [Manually create JSON metadata for custom functions](custom-functions-json.md)
- [Autogenerate JSON metadata for custom functions](custom-functions-json-autogeneration.md)
