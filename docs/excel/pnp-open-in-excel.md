---
title: Create an Excel spreadsheet from your web page, populate it with data, and embed your Office Add-in
description: Create an Excel spreadsheet from your web page, populate it with data, and embed your Office Add-in.
ms.date: 01/23/2023
ms.localizationpriority: medium
---

# Open Excel from your web page and embed your Office Add-in

:::image type="content" source="../images/pnp-open-in-excel.png" alt-text="Image of Excel button on your web page opening up a new Excel document with your add-in embedded and auto-opening.":::

Extend your SaaS web application so that your customers can open their data from a web page directly to Microsoft Excel.

## Contoso success story: Integrate web site data with an Excel add-in

At Contoso, we built an add-in that helps our customers manage their financial data in Excel. We also have a web site that provides customers with the ability to connect their data from any location and manage it in one location. We learned that frequently customers wanted to query data on our web site, and then open it in Excel to take advantage of the many analysis features available in Excel.

to open their data in Excel, they first exported to a .csv file. Then they imported it into Excel. If they made changes they needed to export from Excel, and then import back into our web site. This was a clunky process to say the least. Also they weren't always taking advantage of our Excel add-in to work with the data once in Excel.

We fixed this by adding an Excel icon/button to our web site. When the customer chooses the button, it automatically creates a new spreadsheet with the requested data, uploads it to the customer's OneDrive, and opens it in Excel on a new tab. Their data is already there, and formatted correctly. As a bonus we embed our own add-in in the spreadsheet so the customer can still access functionality from the Contoso web site.

This experience is much better for our customers. They click once, and a new spreadsheet opens with their data already there. We also noticed more usage of our add-in once customers were aware it was already available in the new spreadsheet.

## Prerequisites

- [Visual Studio 2022 or later](https://aka.ms/VSDownload). Add the Office/SharePoint development workload when configuring Visual Studio.
- [Visual Studio Code](https://code.visualstudio.com/Download).
- Microsoft 365. You can get a free developer sandbox that provides a renewable 90-day Microsoft 365 E5 developer subscription. The developer sandbox includes a Microsoft Azure subscription that you can use for app registrations in later steps in this article. If you prefer, you can use a separate Microsoft Azure subscription for app registrations. Get a trial subscription at Microsoft Azure.

## Add an Excel button to the web site

The sample contains a web application that will display mock data from a Contoso web site. You need to add an Excel button to the web application to open the data in a new Excel spreadsheet.

1. Add an image to the navigation pane using the Fluent UI Excel icon.
1. Add a function to call an Azure function. Pass the data to the Azure function, and the function will return a byte array that is the new spreadsheet.

## Upload the spreadsheet to OneDrive

1. Get a Microsoft Graph client.
1. Call the REST API to put a new spreadsheet on the server.

## Open the new spreadsheet

1. Enter the following code to open a new tab with the new spreadsheet.

## How the sample works

The sample code is built on the identity sample at. Refer to these samples for the platform you are using.

Architecture diagram (Azure function, web app, Open XML SDK, VS Code, VS, )

### Create the spreadsheet

The sample code uses the OOXML SDK to embed the Script Lab add-in to the Excel document that you choose. The following information is taken from the [**About the code** section](https://github.com/OfficeDev/Office-OOXML-EmbedAddin/blob/master/README.md) in the readme file.

- Contains mainly code that was generated by the Open XML 2.5 SDK Productivity Tools which are available at the link for the [Open XML 2.5 SDK](/office/open-xml/open-xml-sdk).

### Populate the spreadsheet with data

### Embed your add-in

he **GenerateWebExtensionPart1Content** method in the **OOXMLHelper.cs** file sets the reference to the ID of Script Lab in Microsoft AppSource:

```csharp
We.WebExtensionStoreReference webExtensionStoreReference1 = new We.WebExtensionStoreReference() { Id = "wa104380862", Version = "1.1.0.0", Store = "en-US", StoreType = "OMEX" };
```

- The **StoreType** value is "OMEX", an alias for Microsoft AppSource.
- The **Store** value is "en-US" found in the Microsoft AppSource culture section for Script Lab.
- The **Id** value is the Microsoft AppSource asset ID for Script Lab.

If you are setting up an add-in from a file share catalog for auto-open, you will use different values:

The **StoreType** value is "FileSystem".

- The **Store** value is the URL of the network share; for example, "\\\\MyComputer\\MySharedFolder". This should be the exact URL that appears as the share's Trusted Catalog Address in the Office Trust Center.
- The **Id** value is the app ID in the add-ins manifest.
> [!NOTE]
> For more information about alternative values for these attributes, see [Automatically open a task pane with a document](../develop/automatically-open-a-task-pane-with-a-document.md).

### Upload the spreadsheet to OneDrive

### Open the spreadsheet in a new tab


## Use the Fluent UI

:::image type="content" source="../images/fluent-ui-wxp.png" alt-text="Fluent UI icons for Word, Excel, and PowerPoint.":::

A best practice is to use the Fluent UI to help your users transition between Microsoft products. You should always use an Office icon to indicate which Office application will be launched from your web page. For more information, see [Office Brand Icons](https://developer.microsoft.com/fluentui#/styles/web/office-brand-icons) on the Fluent UI developer portal.  



## Additional considerations for your solution

Everyone’s solution is different in terms of technologies and approaches. The following considerations will help you plan how to modify your solution to open documents and embed your Office Add-in.

### Read custom properties when your add-in starts

The code sample stores a snippet ID in the new Excel document using the OOXML SDK. Script Lab reads the snippet ID from the Excel document and then displays that snippet code when it opens. You may need to send custom properties to your own add-in (such as a query string, or temporary authentication token.) See **Persisting add-in state and settings** for complete details on how to read custom properties when your add-in starts.

### Working with the OOXML SDK

The OOXML SDK is based on .NET. If your web application does not .NET, you’ll need to look for an alternative way to work with OOXML.

You can place the OOXML code in an Azure function to separate the .NET code from the rest of your web application. Then call the Azure function (to generate the Excel document) from your Web application. For more information on Azure functions, see [An introduction to Azure Functions](/azure/azure-functions/functions-overview).

TBD List OOXML JS libraries here.

### Use single sign-on

To simplify authentication, we recommend your add-in implements single sign-on. For more information, see [Enable single sign-on for Office Add-ins](../develop/sso-in-office-add-ins.md)

## See also

- [Welcome to the Open XML SDK 2.5 for Office](/office/open-xml/open-xml-sdk)
- [Automatically open a task pane with a document](../develop/automatically-open-a-task-pane-with-a-document.md)
- [Persisting add-in state and settings](../develop/persisting-add-in-state-and-settings.md)
- [Create a spreadsheet document by providing a file name](/office/open-xml/how-to-create-a-spreadsheet-document-by-providing-a-file-name)